# *CVE-2021-40444 Microsoft MSHTML Remote Code Execution*

There is a security vulnerability **in MSHTML** that can allow an attacker to execute arbitrary code on a vulnerable system.[[1]](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444) Detecting Zero-Day vulnerabilities in MSHTML allows a hacker to infect a victim system with a Word file without using Macro!

The new CVE-2021-40444 vulnerability with a score of 8.8 (out of 10) is a remote code execution security breach that exploits a flaw in MSHTML. The MSHTML service is a dedicated browser engine used to display web content within Office documents. By sending a Word file, the hacker opens a window in the destination browser and, by controlling the vulnerable browser, easily infects the victim system and carries out its attacks.

**The term zero-day may refer to the vulnerability itself, or an attack that has zero days between the time the vulnerability is discovered and the first attack.**[[2]](https://krebsonsecurity.com/2021/09/microsoft-attackers-exploiting-windows-zero-day-flaw)

No solution has been released for this vulnerability, but users can reduce the risk by disabling all ActiveX controls in Internet Explorer.

# *The CVE-2021-40444 Exploit Mechanism*

We are going to analyse the exploit sample files are downloaded from  [https://github.com/klezVirus/CVE-2021-40444](https://github.com/klezVirus/CVE-2021-40444).

As you may know, Docx file is made up of a collection of XML files enclosed in a ZIP package. Unzipping the contents of a new Word document allows you to see what's inside.

![1](https://user-images.githubusercontent.com/90869009/160325889-18092c10-3ef7-4664-b85c-6e3a0eb9a33f.jpg)



In the ~/word dierectory the  "document.xml" contains the contents of your Docx file in XML format. There is another important doc file, the "document.xml.rels"  which is normaly an  XML file that maps relationships between internal/External resources such as (font, theme, and web settings, etc.) within the ". docx file". 

But in malicious word documents when you open document.xml.rels, you'll see an interesting external URL that leads to an html file (5L2FYBG89YWS.html). 

![2](https://user-images.githubusercontent.com/90869009/160330783-b183269a-2fa3-4d6e-992b-2127310ea33a.jpg)

What is this for? In fact, an html request is sent to the server to download .cab file (5L2FYBG89YWS.cab). " A file with the .CAB file extension is a Windows Cabinet file (they used to be called Diamond files). They're compressed files that store data related to various Windows installations that might involve device drivers or system files".[[3]](https://www.lifewire.com/cab-file-4144227)



 # *References*
 [[1]. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)
 
 [[2].  https://www.sciencedirect.com/topics/computer-science/zero-day-attack]( https://www.sciencedirect.com/topics/computer-science/zero-day-attack).

 [[3]. https://www.lifewire.com/cab-file-4144227](https://www.lifewire.com/cab-file-4144227)
 
 [[4]. www.](https://)






